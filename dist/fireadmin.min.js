!function(a){function b(a){if("undefined"==typeof a||"string"!=typeof a)throw new Error("Url is required to use FireAdmin");var b=new Firebase(a);return b.fbUrl=a,b}function c(a,b){return a&&"function"==typeof a?b?a(b):a():void 0}function d(){{var b="2.1.2";e(a.Firebase.SDK_VERSION),e(b)}if("undefined"==typeof a.Firebase)throw new Error("Firebase is required to use FireAdmin")}function e(a){return a.replace(".","").replace(".","")}d(),b.prototype.createObject=function(a,b,d,e){var f=this.getAuth();f&&(b.author=f.uid),b.createdAt=Date.now();this.child(a).push(b,function(a){a?c(e,a):c(d,b)})},b.prototype.emailAuth=function(a,b,d){var e=this;e.authWithPassword(a,function(a,f){null===a?(e.setupPresence(f.uid),c(b,f)):c(d,a)})},b.prototype.listByCurrentUser=function(a,b,d){var e=this.getAuth();if(null!=e)this.child(a).orderByChild("author").equalTo(e.uid).on("value",function(a){c(b,a.val())},function(a){c(d,a)});else{var f={code:"INVALID_AUTH",message:"listByCurrentUser cannot load list without current user"};c(d,f)}},b.prototype.listByUid=function(a,b,d,e){this.fbRef(a).orderByChild("author").equalTo(b).on("value",function(a){c(d,a.val())},function(a){c(e,a)})},b.prototype.objectCount=function(a,b,d){this.fbRef(a).on("value",function(a){c(b,a.numChildren())},function(a){c(d,a)})},b.prototype.userCount=function(a,b){this.child("users").on("value",function(b){c(a,b.numChildren())},function(a){c(b,a)})},b.prototype.onlineUserCount=function(a,b){this.child("presence").on("value",function(b){c(a,b.numChildren())},function(a){c(b,a)})},b.prototype.accountByUid=function(a,b,d){this.child(a).on("value",function(a){c(b,a.val())},function(a){c(d,a)})},b.prototype.accountByEmail=function(a,b,d){a&&"string"==typeof a?this.child("users").orderByChild("email").equalTo(a).on("value",function(a){c(b,a.val())},function(a){c(d,a)}):c(d)},b.prototype.setupPresence=function(a){{var b=this,c=b.child(".info/connected"),d=b.child("presence").child(a),e=b.child("sessions"),f=(b.child("users").child(a),b.child("users").child(a).child("sessions"));f.child("past")}c.on("value",function(c){if(c.val()){var g=(b.onDisconnect(),e.push({began:Firebase.ServerValue.TIMESTAMP,user:a})),h=g.child("ended");h.onDisconnect().set(Firebase.ServerValue.TIMESTAMP);var i=f.child("current").push(g.key());i.onDisconnect().remove(),d.set(!0),d.onDisconnect().remove(),b.onAuth(function(a){a||(h.set(Firebase.ServerValue.TIMESTAMP),i.remove(),d.remove())})}})},b.prototype.fbRef=function(){var a=this,b=Array.prototype.slice.call(arguments);return b.length&&(a=a.child(pathRef(b))),a}}(window,document);